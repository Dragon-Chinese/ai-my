
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{O as A,P as D,d as F,r as f,u as E,z as M,o as S,c as U,e as s,w as l,f as a,g as B,b as o,p as i,t as g,h as v,M as x}from"./index-CT_znvxk.js";const L=A("timer",{state:()=>({isReporting:!1,timenum:30,timerInterval:null,announcementLog:[],prefixText:"",suffixText:"",txtDisabled:!1}),actions:{startTimer(){this.timerInterval&&clearInterval(this.timerInterval),console.log(`定时器启动，间隔 ${this.timenum} 分钟`),this.timerInterval=setInterval(()=>{this.addCustomizeAudio()},this.timenum*60*1e3)},stopTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null),console.log("定时器已停止")},async addCustomizeAudio(){this.txtDisabled=!0;const r=`${this.prefixText}${this.formatCurrentTime()}${this.suffixText}`;try{const e=await D.post("http://localhost:3201/api/CustomizeAudio",{txt:r});this.announcementLog.unshift(`已报时：${this.formatCurrentTime()}`)}catch(e){console.error(e),ElMessage.error("生成失败")}finally{this.txtDisabled=!1}},formatCurrentTime(){const r=new Date,e=r.getHours(),u=r.getMinutes();return`${e}点${u}分`}}}),N={style:{padding:"16px"},class:"gutter-setting"},H={class:"gutter-setting-content",style:{"min-height":"90vh"}},K={class:"gutter-setting-content-set chime"},O={class:"chime-minute"},P={class:"chime-content"},j={class:"button-block",style:{"margin-bottom":"30px"}},q={class:"table-block",style:{"margin-top":"0"}},G={class:"gutter-setting-content",style:{"min-height":"90vh"}},J={class:"input-block"},Q={class:"button-block",style:{"margin-bottom":"4px"}},X=F({__name:"index",setup(r){const e=L(),u=f(e.timenum),_=f(""),m=f(""),c=f(!1),C=E(),h=()=>{_.value=e.formatCurrentTime()},b=()=>{e.startTimer()},V=()=>{e.stopTimer()};M(()=>e.isReporting,d=>{d?(e.addCustomizeAudio(),b()):(V(),x.info("提示",{description:"报时已关闭"}))}),S(()=>{h(),setInterval(h,60*1e3)});const w=()=>{e.timenum=u.value,console.log(`时间间隔更新为：${e.timenum} 分钟`),e.isReporting&&(e.stopTimer(),b())},I=async()=>{m.value&&(c.value=!0,await C.CustomizeAudio(m.value).then(d=>{x.success("提示",{description:"正在生成中..."}),c.value=!1,m.value=""}).catch(d=>{c.value=!1,x.error("提示",{description:"失败"})}))};return(d,t)=>{const p=a("el-input"),T=a("el-button"),$=a("el-form"),k=a("el-table-column"),z=a("el-table"),y=a("el-col"),R=a("el-row");return B(),U("div",N,[s(R,{gutter:16},{default:l(()=>[s(y,{xs:12,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o("div",H,[t[10]||(t[10]=o("div",{class:"gutter-setting-content-title"},"报时",-1)),o("div",K,[s($,{ref:"formRef2",model:d.validateForm2,"label-width":"auto",class:"demo-ruleForm"},{default:l(()=>[t[7]||(t[7]=o("div",{class:"gutter-setting-content-subtitle"},"每隔几分钟报时",-1)),o("div",O,[s(p,{type:"number'",autocomplete:"off",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=n=>u.value=n),placeholder:"请输入",onChange:w},null,8,["modelValue"]),t[6]||(t[6]=o("span",null,"分钟",-1))]),t[8]||(t[8]=o("div",{class:"gutter-setting-content-subtitle"},"报时内容",-1)),o("div",P,[s(p,{type:"number'",autocomplete:"off",modelValue:i(e).prefixText,"onUpdate:modelValue":t[1]||(t[1]=n=>i(e).prefixText=n),placeholder:"请输入前置内容（可不填）"},null,8,["modelValue"]),o("span",null,g(_.value),1),s(p,{type:"number'",autocomplete:"off",modelValue:i(e).suffixText,"onUpdate:modelValue":t[2]||(t[2]=n=>i(e).suffixText=n),placeholder:"请输入后置内容（可不填）"},null,8,["modelValue"])]),o("div",j,[s(T,{color:"#3E61FF",onClick:t[3]||(t[3]=n=>{i(e).isReporting=!i(e).isReporting})},{default:l(()=>[v(g(i(e).isReporting?"关闭报时":"开启报时"),1)]),_:1})])]),_:1},8,["model"]),t[9]||(t[9]=o("div",{class:"gutter-setting-content-subtitle"},"报时记录",-1)),o("div",q,[s(z,{data:i(e).announcementLog,border:"",style:{width:"100%"},"max-height":"550px"},{default:l(()=>[s(k,null,{default:l(n=>[v(g(n.row),1)]),_:1})]),_:1},8,["data"])])])])]),_:1}),s(y,{xs:12,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o("div",G,[t[11]||(t[11]=o("div",{class:"gutter-setting-content-title"},"插话",-1)),o("div",J,[s(p,{type:"textarea",autocomplete:"off",modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=n=>m.value=n),placeholder:"请输入内容",rows:"24"},null,8,["modelValue"])]),o("div",Q,[s(T,{color:"#3E61FF",onClick:t[5]||(t[5]=n=>I())},{default:l(()=>[v(g(c.value.value?"生成中....":"生成"),1)]),_:1})])])]),_:1})]),_:1})])}}});export{X as default};
