
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as T,u as j,r,z as S,o as J,c as D,b as a,C as A,A as K,I as Y,J as G,e as c,w as _,p as g,F as O,L as Q,f as b,g as x,h,t as y,M as i,_ as R}from"./index-CT_znvxk.js";const W="data:image/svg+xml,%3csvg%20width='16'%20height='15'%20viewBox='0%200%2016%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.3333%200.1C11.1333%20-0.0333333%2010.8667%20-0.0333333%2010.6667%200.1L4.53333%203.36667H0.666667C0.266667%203.36667%200%203.63333%200%204.03333V10.7C0%2011.1%200.266667%2011.3667%200.666667%2011.3667H4.53333L10.7333%2014.6333C10.8%2014.7%2010.9333%2014.7%2011.0667%2014.7C11.2%2014.7%2011.3333%2014.7%2011.4%2014.6333C11.6%2014.5%2011.7333%2014.3%2011.7333%2014.0333V0.7C11.6667%200.433333%2011.5333%200.233333%2011.3333%200.1ZM4%2010.0333H1.33333V4.7H4V10.0333ZM10.3333%2012.9L5.33333%2010.3V4.43333L10.3333%201.83333V12.9ZM13.3333%204.03333C13.5333%204.03333%2013.6667%203.96667%2013.8%203.83333L15.2%202.43333C15.4667%202.16667%2015.4667%201.76667%2015.2%201.5C14.9333%201.23333%2014.5333%201.23333%2014.2667%201.5L12.8667%202.9C12.6%203.16667%2012.6%203.56667%2012.8667%203.83333C13%203.96667%2013.1333%204.03333%2013.3333%204.03333ZM13.8%2010.9C13.5333%2010.6333%2013.1333%2010.6333%2012.8667%2010.9C12.6%2011.1667%2012.6%2011.5667%2012.8667%2011.8333L14.2667%2013.2333C14.4%2013.3667%2014.6%2013.4333%2014.7333%2013.4333C14.8667%2013.4333%2015.0667%2013.3667%2015.2%2013.2333C15.4667%2012.9667%2015.4667%2012.5667%2015.2%2012.3L13.8%2010.9ZM15.3333%206.7H13.3333C12.9333%206.7%2012.6667%206.96667%2012.6667%207.36667C12.6667%207.76667%2012.9333%208.03333%2013.3333%208.03333H15.3333C15.7333%208.03333%2016%207.76667%2016%207.36667C16%206.96667%2015.7333%206.7%2015.3333%206.7Z'%20fill='%233E61FF'/%3e%3c/svg%3e",X={style:{padding:"16px"}},ee={class:"PageMain"},te=["element-loading-text"],se={class:"buttonBox flex"},ae={class:"switch-block"},oe={class:"switch-block-item"},ie={class:"switch-block-item"},le=["element-loading-text"],ne={class:"goods-title"},ce={class:"goods-title-left"},de=["src"],re={class:"goods-title-text"},ue={class:"link"},pe={class:"name"},ve={class:"id"},_e={class:"radio-block"},he={class:"opi"},fe={class:"opi-content"},me={class:"script"},ge={class:"input-block"},we={class:"buttonBox flex"},Ce=T({__name:"index",setup(ye){const s=j();r(!1),r(!0),r(!0),r(1);const u=r(!1),d=r([]),w=r(""),f=r(!1),k=r(!1),V=r(!1),H=async()=>{u.value=!0,w.value="正在打开百应后台...",await s.bai_ying("https://buyin.jinritemai.com/dashboard/live/control?").then(t=>{i.success("提示",{description:"已打开"}),u.value=!1,setTimeout(()=>{z()},2e3)}).catch(t=>{u.value=!1,i.error("提示",{description:"打开失败"})})};S(V,async(t,e)=>{U(t)});const U=async t=>{await s.win(t).then(e=>{i.success("提示",{description:"设置成功"})}).catch(e=>{i.error("提示",{description:"设置失败"})})},Z=async(t,e)=>{u.value=!0,w.value="正在智能写话术中...",await E(t,e),u.value=!1};S(k,async(t,e)=>{N(t)});const N=async t=>{await s.zhipu_ai_write_shop(s.initData.zhipu_api_key,s.initData.zhipu_model,s.initData.zhipu_system,t).then(e=>{i.success("提示",{description:"设置成功"})}).catch(e=>{i.error("提示",{description:"设置失败"})})},z=async()=>{u.value=!0,w.value="正在获取商品信息&商品信息智能话术书写中...";try{const t=await s.get_dom();i.success("提示",{description:t.data.message}),console.log("dadada",t),d.value=t.data,w.value="商品信息智能话术书写中...";const e=d.value.map((o,p)=>o.Ai_txt?Promise.resolve():E(o,p));await Promise.all(e)}catch(t){console.log(t),i.error("提示",{description:"重写话术出错"})}finally{u.value=!1}},E=async(t,e)=>{try{const o=await s.shop_txt(t.side_panel_data||t.title);d.value[e].Ai_txt=o.data,L(e)}catch(o){i.error("提示",{description:o.response.data.message})}},L=async t=>{const e=d.value[t].Ai_txt.split(`
`).filter(n=>n.trim()!=="");let o=[];e.forEach(n=>{const m=n.match(/[^。！？]+[。！？]+|[^。！？]+$/g);m?o.push(...m):o.push(n)}),o=o.filter(n=>{const m=n.trim();return m!==""&&m.length>=2});let p=[],v="";for(let n=0;n<o.length;n++)v+=o[n],v.length>=50&&(p.push(v),v="");v&&p.push(v),d.value[t].Ai_list=p,B()},$=async()=>{await s.shop_save([]).then(t=>{d.value=[],i.success("提示",{description:"更改成功"})}).catch(t=>{i.error("提示",{description:t.response.data.message})})},B=async()=>{await s.shop_save(d.value).then(t=>{i.success("提示",{description:"操作成功"})}).catch(t=>{i.error("提示",{description:t.response.data.message})})},q=async()=>{f.value=!0,await s.start_live().then(t=>{f.value=!1,i.success("提示",{description:"开启播报"})}).catch(t=>{f.value=!1,i.error("提示",{description:"开启播报错误"})})},I=async()=>{await s.stop_live_speech().then(t=>{f.value=!1,i.success("提示",{description:"已停止"})}).catch(t=>{f.value=!1,i.error("提示",{description:"停止错误"})})},P=async t=>{await s.start_live_now(t.id).then(e=>{i.success("提示",{description:"切换讲解成功"})}).catch(e=>{i.error("提示",{description:"切换讲解错误"})})};return J(()=>{d.value=s.initData.shop_list,k.value=s.initData.use_zhipu_shop,f.value=s.initData.live,V.value=s.initData.live_see}),(t,e)=>{const o=b("el-button"),p=b("el-switch"),v=b("el-checkbox"),n=b("el-input"),m=b("el-empty"),M=Y("loading");return x(),D("div",X,[a("div",ee,[A((x(),D("div",{class:"grid-content","element-loading-text":w.value},[e[8]||(e[8]=G('<div class="tips" data-v-f4300f0e><div class="tips-cont" data-v-f4300f0e><img src="'+W+'" alt="" data-v-f4300f0e><span data-v-f4300f0e>首次链接百应平台选择：</span><span class="colors" data-v-f4300f0e>达人入住 → 登录 ，</span><span data-v-f4300f0e>登陆成功后关闭百应后台浏览器，再次连接即可成功，</span><a class="colors" href="https://www.yuque.com/zhibaoai/cu4g1z/xdhwzp7apbq0qy0y?singleDoc# " target="_blank" data-v-f4300f0e>点击查看使用教程视频</a></div></div>',1)),a("div",se,[c(o,{color:"#3E61FF",disabled:g(s).initData.open_page,onClick:H},{default:_(()=>[h(y(g(s).initData.open_page?"已连接百应后台，请勿关闭浏览器":"连接/绑定百应后台"),1)]),_:1},8,["disabled"]),c(o,{color:"#3E61FF",disabled:!g(s).initData.open_page,onClick:z},{default:_(()=>e[2]||(e[2]=[h("更新商品数据")])),_:1},8,["disabled"]),c(o,{color:"#3E61FF",onClick:$},{default:_(()=>e[3]||(e[3]=[h("一键清空")])),_:1}),c(o,{color:"#3E61FF",disabled:!g(s).initData.open_page&&!d.value.length||f.value,onClick:q},{default:_(()=>e[4]||(e[4]=[h("开启直播播报")])),_:1},8,["disabled"]),c(o,{color:"#3E61FF",onClick:I},{default:_(()=>e[5]||(e[5]=[h("停止")])),_:1})]),e[9]||(e[9]=a("div",{class:"warnBox"},"恶意调用《智能写话术》账号将会被封禁！",-1)),a("div",ae,[a("div",oe,[e[6]||(e[6]=a("span",null,"是否开启智能重写",-1)),c(p,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l)},null,8,["modelValue"])]),a("div",ie,[e[7]||(e[7]=a("span",null,"智能回复的内容包含链接的内容是否弹出对应商品弹窗",-1)),c(p,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=l=>V.value=l)},null,8,["modelValue"])])])],8,te)),[[M,u.value]]),d.value.length?(x(!0),D(O,{key:0},Q(d.value,(l,F)=>A((x(),D("div",{class:"goods","element-loading-text":w.value},[a("div",ne,[a("div",ce,[a("img",{src:l.img_src,alt:""},null,8,de),a("div",re,[a("div",ue,y(F+1)+"号链接",1),a("div",pe,"商品名称："+y(l.title),1),a("div",ve,"商品ID： "+y(l.id),1)])]),a("div",_e,[c(v,{modelValue:l.see,"onUpdate:modelValue":C=>l.see=C,onChange:B,label:"是否自动讲解",size:"large"},null,8,["modelValue","onUpdate:modelValue"])])]),a("div",he,[e[10]||(e[10]=a("div",{class:"opi-title"},"产品信息",-1)),a("div",fe,[a("div",null,y(l.side_panel_data),1)])]),a("div",me,[e[13]||(e[13]=a("div",{class:"script-title"},"智能话术",-1)),a("div",ge,[c(n,{type:"textarea",modelValue:l.Ai_txt,"onUpdate:modelValue":C=>l.Ai_txt=C,style:{height:"399px"},placeholder:"请输入话术"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",we,[c(o,{color:"#3E61FF",onClick:C=>Z(l,F)},{default:_(()=>e[11]||(e[11]=[h(" 智能写话术 ")])),_:2},1032,["onClick"]),c(o,{color:"#3E61FF",onClick:C=>L(F)},{default:_(()=>e[12]||(e[12]=[h(" 保存 ")])),_:2},1032,["onClick"]),c(o,{type:g(s).initData.shop_id==l.id?"warning":"primary",color:"#3E61FF",disabled:g(s).initData.shop_id==l.id,onClick:C=>P(l)},{default:_(()=>[h(y(g(s).initData.shop_id==l.id?"讲解中...":"讲解"),1)]),_:2},1032,["type","disabled","onClick"])])])],8,le)),[[M,u.value]])),256)):(x(),K(m,{key:1,"image-size":200}))])])}}}),xe=R(Ce,[["__scopeId","data-v-f4300f0e"]]);export{xe as default};
